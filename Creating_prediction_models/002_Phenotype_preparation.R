###############################################################################
### Phenotype data preparations for blood group antigens
###############################################################################

library(tidyverse)

###############################################################################
### Phenotype information

## The following scripts require blood group phenotype data table "BG_phenos"

# Example file "Example_BG_phenos" is provided.
Example_BG_phenos <- read_table("Creating_prediction_models/Example_BG_phenos") %>% 
  as_tibble()
# Structure specification example
str(Example_BG_phenos)
  # tibble [9 × 54] (S3: tbl_df/tbl/data.frame), columns:
  # $ releasedIdentifier: chr [1:9] Sample1" "Sample2" "Sample3" "Sample4" ...
  # $ ABO               : chr [1:9] "A" "B" "AB" "O" ...
  # $ D                 : chr [1:9] "D+" "D+" "D+" "D-" ...
  # $ C                 : chr [1:9] "C+" "C+" "C+" "C-" ...
  # $ E                 : chr [1:9] "E+" "E-" "E-" "E-" ...
  # $ c                 : chr [1:9] "c+" "c-" "c+" "c+" ...
  # $ e                 : chr [1:9] "e+" "e+" "e+" "e+" ...
  # $ Cw                : chr [1:9] "Cw-" "Cw-" "Cw-" "Cw-" ...
  # $ Cx                : chr [1:9] "Cx-" NA NA NA ...
  # ...  n. column, include all the blood group information into columns                

## The following scripts require blood group phenotype gene data table "Pheno_info"

# Example file "Example_Pheno_info" is provided.
Example_Pheno_info <- read_table("Creating_prediction_models/Example_Pheno_info") %>% 
  as_tibble()
# Structure specification example
str(Example_Pheno_info)
  # tibble [53 × 7] (S3: tbl_df/tbl/data.frame)
  # $ Phenotype    : chr [1:53] "ABO" "A1" "A2" "Yta" ...
  # $ BG_system    : chr [1:53] "ABO" "ABO" "ABO" "Cartwright" ...
  # $ Pheno_genes  : chr [1:53] "ABO" "ABO" "ABO" "ACHE" ...
  # $ Gene1        : chr [1:53] "ABO" "ABO" "ABO" "ACHE" ...
  # $ Gene2        : chr [1:53] NA NA NA NA ...
  # $ Gene3        : chr [1:53] NA NA NA NA ...
  # $ Plink_dataset: chr [1:53] "data/BG_genes/ABO_ABO_2K.vcf" "data/BG_genes/ABO_ABO_2K.vcf" ...

  # Column Pheno_genes contains all genes separated by _ e.g. GYPA_GYPB_GYPE, RHCE_RHD
  # Column Plink_dataset contains PLINK dataset prefixes generated using 001_Genotype_preparation.R script

###############################################################################
